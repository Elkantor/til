{"data":{"site":{"siteMetadata":{"title":"TIL"}},"markdownRemark":{"id":"4b384b78-b0d0-5fb2-b7f7-64db0af7aaf8","excerpt":"We load our gems from  Rubygems , but a lot of you may still be placing your JavaScripts into  vendor/assets/javascripts . Why not use  npm…","htmlAst":{"type":"element","tagName":"div","properties":{},"children":[{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"We load our gems from "},{"type":"element","tagName":"a","properties":{"href":"https://rubygems.org/"},"children":[{"type":"text","value":"Rubygems"}]},{"type":"text","value":", but a lot of you may still be placing your JavaScripts into "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"vendor/assets/javascripts"}]},{"type":"text","value":". Why not use "},{"type":"element","tagName":"a","properties":{"href":"https://www.npmjs.com/"},"children":[{"type":"text","value":"npm"}]},{"type":"text","value":"? It's actually pretty easy to set up Rails to use npm."}]},{"type":"element","tagName":"h2","properties":{},"children":[{"type":"text","value":"Use npm itself"}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"The best way to load npm packages in Rails is to use npm as your pipeline itself. "},{"type":"element","tagName":"a","properties":{"href":"https://github.com/rstacruz/npm-pipeline-rails"},"children":[{"type":"text","value":"npm-pipeline-rails"}]},{"type":"text","value":" helps you do just that."}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Don't want to switch away from the asset pipeline? That's fine, read on for an alternative approach."}]},{"type":"element","tagName":"h2","properties":{},"children":[{"type":"text","value":"Alternative"}]},{"type":"element","tagName":"h3","properties":{},"children":[{"type":"text","value":"Add "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"node_modules"}]},{"type":"text","value":" to your gitignore"}]},{"type":"comment","value":" {.-literate-style} "},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Because you don't want to commit those, just like you don't commit your gems."}]},{"type":"element","tagName":"pre","properties":{},"children":[{"type":"element","tagName":"code","properties":{"className":["language-bash"]},"children":[{"type":"text","value":"echo '/node_modules' >> .gitignore\n"}]}]},{"type":"element","tagName":"h3","properties":{},"children":[{"type":"text","value":"Create a "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"package.json"}]},{"type":"text","value":" in your project"}]},{"type":"comment","value":" {.-literate-style} "},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"This is the npm equivalent of a "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"Gemfile"}]},{"type":"text","value":"—it's where your packages are stored."}]},{"type":"element","tagName":"pre","properties":{},"children":[{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"npm init\n"}]}]},{"type":"element","tagName":"h3","properties":{},"children":[{"type":"text","value":"Add "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"node_modules"}]},{"type":"text","value":" to your asset path"}]},{"type":"comment","value":" {.-literate-style} "},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"This lets you use npm modules in your Sprockets assets. In "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"config/application.rb"}]},{"type":"text","value":":"}]},{"type":"element","tagName":"pre","properties":{},"children":[{"type":"element","tagName":"code","properties":{"className":["language-rb"]},"children":[{"type":"text","value":"module YourApp\n  class Application < Rails::Application\n    config.assets.paths << Rails.root.join('node_modules')\n"}]}]},{"type":"element","tagName":"h3","properties":{},"children":[{"type":"text","value":"Run "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"npm install"}]},{"type":"text","value":" on startup"}]},{"type":"comment","value":" {.-literate-style} "},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Rails (or Bundler) prevents you from starting itself when you have gems that aren't installed yet. To emulate that behavior for npm packages, do this in "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"config/initializers/npm.rb"}]},{"type":"text","value":":"}]},{"type":"element","tagName":"pre","properties":{},"children":[{"type":"element","tagName":"code","properties":{"className":["language-rb"]},"children":[{"type":"text","value":"system 'npm install' if Rails.env.development? || Rails.env.test?\n"}]}]},{"type":"element","tagName":"h3","properties":{},"children":[{"type":"text","value":"Heroku: add Node.js support"}]},{"type":"comment","value":" {.-literate-style} "},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"If you're deploying to Heroku, the default Ruby buildpack doesn't include Node, which you need to use npm. Add both the Node.js and Ruby buildpacks:"}]},{"type":"element","tagName":"pre","properties":{},"children":[{"type":"element","tagName":"code","properties":{"className":["language-bash"]},"children":[{"type":"text","value":"heroku bulidpacks:add 'https://github.com/heroku/heroku-buildpack-nodejs.git'\nheroku bulidpacks:add 'https://github.com/heroku/heroku-buildpack-ruby.git'\n"}]}]},{"type":"element","tagName":"h2","properties":{},"children":[{"type":"text","value":"Adding JavaScript packages"}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"You can only use node modules that come with a pre-built version in it. "},{"type":"element","tagName":"a","properties":{"href":"https://modernizr.com/"},"children":[{"type":"text","value":"modernizr"}]},{"type":"text","value":" won't work. You can try "},{"type":"element","tagName":"a","properties":{"href":"https://github.com/browserify-rails/browserify-rails"},"children":[{"type":"text","value":"browserify-rails"}]},{"type":"text","value":"."}]},{"type":"element","tagName":"h3","properties":{},"children":[{"type":"text","value":"Use "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"npm install"}]}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Use "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"npm install"}]},{"type":"text","value":" with "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"--save"}]},{"type":"text","value":" to add packages."}]},{"type":"comment","value":" {.-literate-style} "},{"type":"element","tagName":"pre","properties":{},"children":[{"type":"element","tagName":"code","properties":{"className":["language-bash"]},"children":[{"type":"text","value":"npm install --save --save-exact modernizr\n"}]}]},{"type":"element","tagName":"h3","properties":{},"children":[{"type":"text","value":"Add to "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"application.js"}]}]},{"type":"comment","value":" {.-literate-style} "},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Then in your "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"application.js"}]},{"type":"text","value":", require it like so:"}]},{"type":"element","tagName":"pre","properties":{},"children":[{"type":"element","tagName":"code","properties":{"className":["language-js"]},"children":[{"type":"text","value":"//= require onmount/onmount\n"}]}]}]},"fields":{"slug":"/npm-in-rails/"},"frontmatter":{"title":"Using npm packages in Rails","date":"January 21, 2016"}}},"pageContext":{"node_id":"4b384b78-b0d0-5fb2-b7f7-64db0af7aaf8","nodeType":"post","title":"Using npm packages in Rails","slug":"/npm-in-rails/","previous":{"id":"8b024c22-b99c-518e-9ff7-c7687dec6a9c","fields":{"slug":"/ordered-keys-in-js/"},"frontmatter":{"title":"Ordered keys in JS objects"}},"next":{"id":"56ce3b2a-9d81-5ebd-bd48-b43fe22ca94b","fields":{"slug":"/selective-polyfilling/"},"frontmatter":{"title":"Selective polyfilling"}}}}